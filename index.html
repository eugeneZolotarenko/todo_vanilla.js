<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
  <title>Let's Do That</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <svg width="329" height="167" viewBox="0 0 329 167" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect width="312" height="166" fill="#FFC700"/>
    <rect x="8" y="9" width="304" height="157" fill="black"/>
    <path d="M34.524 39.8H39.408V81.776H65.28V86H34.524V39.8ZM106.059 81.776V86H73.3892V39.8H105.069V44.024H78.2732V60.458H102.165V64.616H78.2732V81.776H106.059ZM126.516 44.024H110.28V39.8H147.636V44.024H131.4V86H126.516V44.024ZM156.845 36.698C157.857 36.698 158.693 37.05 159.353 37.754C160.013 38.414 160.343 39.25 160.343 40.262C160.343 40.79 160.255 41.362 160.079 41.978C159.947 42.55 159.749 43.232 159.485 44.024L156.647 53.132H153.479L155.789 43.628C155.041 43.408 154.447 43.012 154.007 42.44C153.567 41.824 153.347 41.098 153.347 40.262C153.347 39.206 153.677 38.348 154.337 37.688C154.997 37.028 155.833 36.698 156.845 36.698ZM184.676 86.396C181.244 86.396 177.944 85.846 174.776 84.746C171.652 83.646 169.232 82.194 167.516 80.39L169.43 76.628C171.102 78.3 173.324 79.664 176.096 80.72C178.868 81.732 181.728 82.238 184.676 82.238C188.812 82.238 191.914 81.49 193.982 79.994C196.05 78.454 197.084 76.474 197.084 74.054C197.084 72.206 196.512 70.732 195.368 69.632C194.268 68.532 192.904 67.696 191.276 67.124C189.648 66.508 187.382 65.848 184.478 65.144C181.002 64.264 178.23 63.428 176.162 62.636C174.094 61.8 172.312 60.546 170.816 58.874C169.364 57.202 168.638 54.936 168.638 52.076C168.638 49.744 169.254 47.632 170.486 45.74C171.718 43.804 173.61 42.264 176.162 41.12C178.714 39.976 181.882 39.404 185.666 39.404C188.306 39.404 190.88 39.778 193.388 40.526C195.94 41.23 198.14 42.22 199.988 43.496L198.338 47.39C196.402 46.114 194.334 45.168 192.134 44.552C189.934 43.892 187.778 43.562 185.666 43.562C181.618 43.562 178.56 44.354 176.492 45.938C174.468 47.478 173.456 49.48 173.456 51.944C173.456 53.792 174.006 55.288 175.106 56.432C176.25 57.532 177.658 58.39 179.33 59.006C181.046 59.578 183.334 60.216 186.194 60.92C189.582 61.756 192.31 62.592 194.378 63.428C196.49 64.22 198.272 65.452 199.724 67.124C201.176 68.752 201.902 70.974 201.902 73.79C201.902 76.122 201.264 78.256 199.988 80.192C198.756 82.084 196.842 83.602 194.246 84.746C191.65 85.846 188.46 86.396 184.676 86.396ZM34.524 119.8H53.334C58.218 119.8 62.53 120.79 66.27 122.77C70.01 124.706 72.914 127.434 74.982 130.954C77.05 134.43 78.084 138.412 78.084 142.9C78.084 147.388 77.05 151.392 74.982 154.912C72.914 158.388 70.01 161.116 66.27 163.096C62.53 165.032 58.218 166 53.334 166H34.524V119.8ZM53.07 161.776C57.118 161.776 60.66 160.984 63.696 159.4C66.732 157.772 69.086 155.55 70.758 152.734C72.43 149.874 73.266 146.596 73.266 142.9C73.266 139.204 72.43 135.948 70.758 133.132C69.086 130.272 66.732 128.05 63.696 126.466C60.66 124.838 57.118 124.024 53.07 124.024H39.408V161.776H53.07ZM109.247 166.396C104.671 166.396 100.513 165.384 96.7733 163.36C93.0773 161.292 90.1733 158.476 88.0613 154.912C85.9933 151.348 84.9593 147.344 84.9593 142.9C84.9593 138.456 85.9933 134.452 88.0613 130.888C90.1733 127.324 93.0773 124.53 96.7733 122.506C100.513 120.438 104.671 119.404 109.247 119.404C113.823 119.404 117.937 120.416 121.589 122.44C125.285 124.464 128.189 127.28 130.301 130.888C132.413 134.452 133.469 138.456 133.469 142.9C133.469 147.344 132.413 151.37 130.301 154.978C128.189 158.542 125.285 161.336 121.589 163.36C117.937 165.384 113.823 166.396 109.247 166.396ZM109.247 162.04C112.899 162.04 116.199 161.226 119.147 159.598C122.095 157.926 124.405 155.638 126.077 152.734C127.749 149.786 128.585 146.508 128.585 142.9C128.585 139.292 127.749 136.036 126.077 133.132C124.405 130.184 122.095 127.896 119.147 126.268C116.199 124.596 112.899 123.76 109.247 123.76C105.595 123.76 102.273 124.596 99.2813 126.268C96.3333 127.896 94.0013 130.184 92.2853 133.132C90.6133 136.036 89.7773 139.292 89.7773 142.9C89.7773 146.508 90.6133 149.786 92.2853 152.734C94.0013 155.638 96.3333 157.926 99.2813 159.598C102.273 161.226 105.595 162.04 109.247 162.04ZM170.666 124.024H154.43V119.8H191.786V124.024H175.55V166H170.666V124.024ZM238.198 119.8V166H233.38V144.682H204.472V166H199.588V119.8H204.472V140.392H233.38V119.8H238.198ZM282.252 153.658H256.512L250.968 166H245.886L267.006 119.8H271.824L292.944 166H287.796L282.252 153.658ZM280.47 149.698L269.382 124.882L258.294 149.698H280.47ZM307.242 124.024H291.006V119.8H328.362V124.024H312.126V166H307.242V124.024Z" fill="#FFC700"/>
  </svg>
   
  <div class="wrapper">
    <h2>üöÄ TO DO:</h2>
    <p></p>
    <ul class="todos">
    </ul>
    <form class="add-items">
      <input class="text" type="text" name="item" placeholder="Item Name" required>
      <input type="submit" value="+ Add Item">
    </form>
    <div class="controls">
        <button class="delete-all">Cleare All</button>
        <button class="delete-last">Remove Last</button>
        <button class="check-all">Check All</button>
        <button class="uncheck-all">Uncheck All</button>
    </div>
    <form class="edit-items edit-items-none">
      <input class="edit-text" type="text" name="item" placeholder="Item Name" required>
      <input type="submit" value="-> Edit Item">
    </form>
  </div>

<script>

  const items = JSON.parse(localStorage.getItem('items')) || [];
  
  const wrapper = document.querySelector('.wrapper');    
  const formEdit = wrapper.querySelector('.edit-items');

  const addItems = document.querySelector('.add-items');
  const itemsList = document.querySelector('.todos');

  const deleteAll = document.querySelector('.delete-all');
  const deleteLast = document.querySelector('.delete-last');
  const deleteOne = document.querySelector('.delete-one');

  const checkAll = document.querySelector('.check-all');
  const uncheckAll = document.querySelector('.uncheck-all');

  function updateLocalStorage() {
    return localStorage.setItem('items', JSON.stringify(items));
  }

  function addItem(e) {
    e.preventDefault();
    const text = (document.querySelector('.text')).value;
    const item = {
      text,
      done: false
    };
    items.push(item);
    populateList(items, itemsList);
    updateLocalStorage();
    this.reset();
  }

  function populateList(todos = [], todosList) {
    todosList.innerHTML = todos.map((todo, i) => {
      return `
        <li>
          <input type="checkbox" data-index=${i} id="item${i}" ${todo.done ? 'checked' : ''} />
          <label for="item${i}">${todo.text}</label>
          <button data-index=${i} class="edit">‚úçüèΩ</button>
          <button data-index=${i} class="delete-one">‚ùå</button>
        </li>
      `;
    }).join('');
  }

  function toggleDone(e) {
    const el = e.target;
    if (!el.matches('[type="checkbox"]')) return;
    const index = el.dataset.index;
    items[index].done = !items[index].done;
    updateLocalStorage();
    populateList(items, itemsList);
  }

  function deleteAllItems() {
    itemsList.innerHTML = "";
    items.length = 0;
    updateLocalStorage();
  }

  function deleteLastItem() {
    items.pop();
    populateList(items, itemsList);
    updateLocalStorage();
  }

  function deleteOneItem(e) {
    const el = e.target;
    if (!el.matches('.delete-one')) return;
    const index = el.dataset.index;
    items.splice(index, 1);
    populateList(items, itemsList);
    updateLocalStorage();
  }  
  
  function editItem(e) {
    const el = e.target;
    if (!el.matches('.edit')) return;
    const index = el.dataset.index;
    const itemLabel = itemsList.querySelector(`[for="item${index}"]`);
    const textToEdit = items[index].text
    if (itemLabel.innerHTML === textToEdit) {
      itemLabel.innerHTML = `
        <form class="edit-items">
          <input class="edit-text" type="text" name="item" value=${textToEdit} placeholder=${textToEdit} required>
          <input type="submit" value="Edit">
        </form>
       `
    } else{
      itemLabel.innerHTML = textToEdit
      
    }
    const editForm = document.querySelector(".edit-items");
    const onSubmitEdit = (e => {
      e.preventDefault();
      const editFormInput = editForm.querySelector("[type='text']");
      const editedText = editFormInput.value;
      items[index].text = editedText;
      updateLocalStorage();
      populateList(items, itemsList);
    })
    editForm.addEventListener("submit", onSubmitEdit);
    editForm.addEventListener("change", onSubmitEdit);
  }

  function checkAllItems() {
    items.map(element => element.done = true);
    populateList(items, itemsList);
    updateLocalStorage();
  }

  function uncheckAllItems() {
    items.map(element => element.done = false);
    populateList(items, itemsList);
    updateLocalStorage();
  }

  addItems.addEventListener('submit', addItem);
  itemsList.addEventListener('click', toggleDone);
  
  deleteAll.addEventListener('click', deleteAllItems);
  deleteLast.addEventListener('click', deleteLastItem);
  itemsList.addEventListener('click', deleteOneItem);

  itemsList.addEventListener('click', editItem);

  checkAll.addEventListener('click', checkAllItems);
  uncheckAll.addEventListener('click', uncheckAllItems);

  populateList(items, itemsList);
  
</script>
  
</body>
</html>

